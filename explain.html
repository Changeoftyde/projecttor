<!DOCTYPE html>
<head>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
</head>
<html>
<body>
<div id="firstpart" class="">
<div id="fullscreen">
 <div id="popup">
   <span id="title">
   </span>
   <div id="showanswer"><span id="desc"></span><div id="gatb"></div></div>
   <div id="torabody"></div>
   <div id="torahead"></div>
   <button id="next" onclick="next()">Next</button>
 </div>
  </div>
  <button onclick="next2()" id="check">Next</button>
 <div id="question"><span style="font-size: 3.5dvh" id="qtext">Find a Friend who needs help Studying. One of you will ask the question while the other explains it. Then click "Next."
 </span></div>
 <div class="hidden" id="question2"><span id="qtext2container"><span id="qtext2"></span><span style="pointer-events: none" onclick="revealanswer()" id="answer2"></span></span></div>
 <div id="circles">
 <div class="hidden" onclick="bien()" id="biencircle"></div>
 <div class="hidden" onclick="mal()" id="malcircle"></div>
 </div>
 <textarea class="hidden" maxlength="1000" placeholder="Type the answer here..." id="answer"></textarea>
 <div id="loadbar"><div id="insloadbar"></div></div><span onclick="window.location.href = 'study'.concat(current.concat('.html'))" id="x">X</span>
</div>
<div id="secondpart" class="hidden">
     <button class="hidden" id="finish" onclick="finish()">Done</button>
   <button class="hidden" id="redo" onclick="redo()">Redo</button>
  <div id="torabody2"></div>
  <div id="torahead2"></div>
  <div class="fmq2"><div id="lilgrayguy"></div></div>
  <div id="fmq">
    <div id="whitebit"></div>
    <span id="sq">Struggle Questions</span>
  </div>
  <div id="percentage">
  <div id="middlecircle">
    <span id="textim"></span>
  </div>
  <div id="frontcircle"></div>
  </div>
</div>
</body>
<style>
#question2 {
  width: calc(100% - 20dvh);
    left: 50%;
    top: 50%;
    height: 45dvh;
    position: absolute;
    overflow-y: scroll;
    color: #c12020;
    transform: translate(-50%, -50%);
    border-radius: 3dvh;
    word-wrap: break-word;
    transition: 0.6s opacity;
    z-index: 16;
}
#circles {
  width: 100dvw;
  top: 0;
  left: 0;
  position: fixed;
  overflow: hidden;
  height: 100dvh;
}
#malcircle {
  right: 1.5dvh;
  top: 50%;
  transform: translate(50%, -50%);
  position: absolute;
  z-index: 101;
  height: 15dvh;
  width: 15dvh;
  border-radius: 6dvh;
  border: 0;
  background-color: #ff8500;
  box-shadow: 0 0 30dvh 10dvh rgba(255, 133, 0, 0.2);
  transition: 0.6s opacity;
}
#biencircle {
  left: 1.5dvh;
  top: 50%;
  transform: translate(-50%, -50%);
  position: absolute;
  z-index: 101;
  height: 15dvh;
  width: 15dvh;
  border-radius: 6dvh;
  border: 0;
  background-color: #2dcc70;
  box-shadow: 0 0 30dvh 10dvh rgba(45, 204, 112, 0.2);
  transition: 0.6s opacity;
}
#question {
   scrollbar-width: none; /* Hides scrollbar in Firefox */
   -ms-overflow-style: none; /* Hides scrollbar in IE and Edge */
}
#question::-webkit-scrollbar {
   display: none; /* Hides scrollbar in Chrome, Safari, and Opera */
}
#question2 {
   scrollbar-width: none; /* Hides scrollbar in Firefox */
   -ms-overflow-style: none; /* Hides scrollbar in IE and Edge */
}
#question2::-webkit-scrollbar {
   display: none; /* Hides scrollbar in Chrome, Safari, and Opera */
}
#time {
  width: 40dvh;
  border: none;
  overflow: auto;
  padding:: 0;
  white-space: nowrap;
  box-sizing: content-box;
    left: 50%;
    height: 14dvh;
    position: absolute;
    top: 40dvh;
    border-radius: 3dvh;
    border: none;
    transform: translateX(-50%);
    font-size: 10dvh;
    font-family: fredokaone;
    color: #c12020;
    padding: 2dvh 2dvh 4dvh 2dvh;
    resize: none;
    transition: 0.6s opacity;
    text-align: center;
}
#finish:hover {
  outline: 1.5dvh solid #c12020;
}
#redo:hover {
  outline: 1.5dvh solid #c12020;
}
#finish {
  width: 12dvh;
  height: 6dvh;
  border-radius: 2dvh;
  border: none;
  outline: 1.5dvh solid #efefef;
  background-color: white;
  color: #c12020;
  left: calc(50% - 15dvh);
  bottom: 54dvh;
  position: absolute;
  z-index: 2;
  font-family: fredokaone;
  font-size: 3.5dvh;
  cursor: pointer;
  transition: 0.6s opacity;
}
#redo {
  width: 12dvh;
  height: 6dvh;
  border-radius: 2dvh;
  border: none;
  outline: 1.5dvh solid #efefef;
  background-color: white;
  color: #c12020;
  left: calc(50% + 3dvh);
  bottom: 54dvh;
  position: absolute;
  z-index: 2;
  font-family: fredokaone;
  font-size: 3.5dvh;
  cursor: pointer;
  transition: 0.6s opacity;
}
#torahead2 {
    z-index: 1001;
    transform: translate(-50%, -50%);
    width: 18.41dvh;
    height: 12.90dvh;
    position: absolute;
    bottom: 5.71dvh; /*+1*/
    left: 50%;
    background-position: 50% 50%;
    background-size: cover;
    background-image: url("toraheadnormal.png");
    transition: 0.8s transform;
    
  }
  #torabody2 {
    bottom: 2.9dvh;
    right: calc(50% - 7.2dvh);
    position: absolute;
    width: 17.56dvh;
    height: 13.42dvh;
    background-position: 50% 50%;
    background-size: cover;
    background-image: url("torabody.png");
    z-index: 1000;
  }
  #lilgrayguy {
    position: absolute;
    top: 12dvh;
    left: 0;
    width: 100%;
    height: 3dvh;
    background-image: linear-gradient(rgba(0,0,0,0), #efefef);
    z-index: 1;
    pointer-events: none;
  }
  #sq {
    width: calc(100% - 3dvh);
    text-align: center;
    color: black;
    top: 0.5dvh;
    left: 3.5dvh;
    position: absolute;
    z-index: 0;
    font-size: 2.5dvh;
    white-space: nowrap;
  }
  #whitebit {
    z-index: 1;
    width: 110%;
    right: -5%;
    top: -5%;
    position: absolute;
    background-color: white;
    height: 110%;
    transition: 1.5s;
  }
  #fmq {
    width: calc(100% - 16dvh);
    height: 15dvh;
    top: 22.5dvh;
    background-color: #efefef;
    position: absolute;
    right: 3dvh;
    border-radius: 3dvh;
    overflow-y: scroll;
    overflow-x: hidden;
  }
  .fmq2 {
    width: calc(100% - 16dvh);
    height: 15dvh;
    top: 22.5dvh;
    background-color: #efefef;
    position: absolute;
    right: 3dvh;
    border-radius: 3dvh;
    overflow-y: scroll;
    overflow-x: hidden;
  }
  #textim {
    color: white;
    transition: 2s;
    position: absolute;
    left: 50%;
    top: 50%;
    transform: translate(-50%, -50%);
    width: 100%;
    text-align: center;
    font-size: 10dvh;
  }
  #middlecircle {
    width: 67.5%;
    height: 67.5%;
    position: absolute;
    left: 50%;
    top: 50%;
    transform: translate(-50%, -50%);
    background-color: white;
    border-radius: 50%;
    z-index: 1; 
  }
  #percentage {
    z-index: 2;
    width: 45dvh;
    height: 45dvh;
    border-radius: 22.5dvh;
    position: absolute;
    left: 50%;
    top: 50%;
    transform: translate(-50%, -50%);
    transition: 2s;
  }
  #frontcircle {
    width: 110%;
    height: 110%;
    left: 50%;
    top: 50%;
    transform: translate(-50%, -50%);
    position: absolute;
    background-color: white;
  }
  #secondpart {
    width: 100%;
    height: 100%;
    position: absolute;
    top: 0;
    left: 0;
  }
  #firstpart {
    width: 100%;
    height: 100%;
    position: absolute;
    overflow-y: hidden;
    top: 0;
    left: 0;
  }
  .hidden {
    opacity: 0;
    pointer-events: none;
  }
  #gatb {
    width: 100%;
    height: 10dvh;
    top: 20dvh;
    position: fixed;
    background-image: linear-gradient(rgba(0, 0, 0, 0), #efefef);
    z-index: 1;
    pointer-events: none;
  }
  #showanswer {
    overflow-y: scroll;
    width: 100%;
    height: 20dvh;
    left: 0;
    top: 10dvh;
    position: absolute;
  }
  #torahead {
    z-index: 2;
    transform: translate(-50%, -50%);
    width: 18.41dvh;
    height: 12.90dvh;
    position: absolute;
    top: -8.31dvh;
    right: -5.2dvh;
    background-position: 50% 50%;
    background-size: cover;
    background-image: url("toraheadnormal.png");
    transition: 0.8s transform;
  }
  #torabody {
    top: -5.5dvh;
    right: 6.03dvh;
    position: absolute;
    width: 17.56dvh;
    height: 13.42dvh;
    background-position: 50% 50%;
    background-size: cover;
    background-image: url("torabody.png");
  }
  #qtext {
    position: absolute;
    left: 0;
    top: 50%;
    width: 100%;
    text-align: center;
    font-size: 4.5dvh;
    transform: translateY(-50%);
  }
  #qtext2container {
    position: absolute;
    left: 0;
    top: 50%;
    width: 100%;
    height: auto;
    text-align: center;
    color: #c12020;
    font-size: 25dvh;
    transform: translateY(-50%);
  }
  #answer2 {
    display: block;
    font-size: 2.5dvh;
  }
  button {
  font-family: fredokaone;
  }
  @font-face {
  font-family: fredokaone;
  src: url("FredokaOne-Regular.otf");
  }
  textarea {
    font-family: fredokaone;
  }
  body {
    font-family: fredokaone;
    overflow: hidden;
  }
  #question {
    width: calc(100% - 8dvh);
    left: 4dvh;
    top: 38dvh;
    height: 20dvh;
    position: absolute;
    overflow-y: scroll;
    color: #c12020;
    border-radius: 3dvh;
    word-wrap: break-word;
    transition: 0.6s opacity;
    scrollbar-width: none; /* Hides scrollbar in Firefox */
    -ms-overflow-style: none; /* Hides scrollbar in IE and Edge */
  }
  #answer {
    width: calc(100dvw - 8.4dvh);
    left: 50%;
    height: 20dvh;
    position: absolute;
    top: 40dvh;
    border-radius: 3dvh;
    border: none;
    transform: translateX(-50%);
    background-color: rgba(200, 200, 200, 0.3);
    font-size: 2.5dvh;
    padding: 2dvh 2dvh 4dvh 2dvh;
    resize: none;
    transition: 0.6s opacity;
  }
  #qtext2 {
    display: block;
  }
  #x {
    color: #c12020;
    font-size: 10dvh;
    text-align: center;
    width: 14.5dvh;
    height: 12.5dvh;
    position: absolute;
    right: 0;
    top: 1dvh;
    transition: 1.4s color;
  }
  #loadbar {
    width: calc(100dvw - 20dvh);
    position: fixed;
    top: 3.5dvh;
    left: 3.5dvh;
    height: 7dvh;
    border-radius: 5dvh;
    outline: 2dvh solid rgba(200, 200, 200, 0.3);
    overflow: hidden;
    transition: 1.4s outline-color;
  }
  #insloadbar {
    height: 100%;
    transition: 0.6s;
    left: 0;
    top: 0;
    border-radius: 5dvh;
    position: absolute;
    background-color: #c12020;
    width: 0;
  }
  #popup {
    z-index: 10;
    width: calc(100% - 4.75dvh);
    height: 100dvh;
    background-color: #efefef;
    position: absolute;
    left: 50%;
    transform: translate(-50%, 0%);
    top: 90dvh;
    border-radius: 4.5dvh;
    transition: 1.4s background-color;
  }
  #title {
    left: 2dvh;
    top: 2dvh;
    width: calc(100% - 4dvh);
    position: absolute;
    font-size: 6dvh;
    transition: 0.6s color;
    color: #efefef;
  }
  #desc {
    left: 2dvh;
    width: calc(100% - 4dvh);
    position: absolute;
    font-size: 6dvh;
    transition: 2s color;
    color: #000000;
    font-size: 3dvh;
    word-wrap: break-word;
  }
  #question::-webkit-scrollbar {
  display: none;
}
#check {
  width: 12dvh;
  height: 6dvh;
  border-radius: 2dvh;
  border: none;
  outline: 1.5dvh solid #efefef;
  background-color: white;
  color: #c12020;
  right: 5dvh;
  bottom: 34dvh;
  position: absolute;
  z-index: 2;
  font-family: fredokaone;
  font-size: 3.5dvh;
  cursor: pointer;
  transition: 0.6s opacity;
}
  body {
    transition: 1.4s background-color;
    overflow-y: hidden;
  }
#next {
  width: 12dvh;
  height: 6dvh;
  border-radius: 2dvh;
  border: none;
  outline: 1.5dvh solid #efefef;
  background-color: white;
  color: #c12020;
  right: 2.625dvh;
  top: 31.5dvh;
  position: absolute;
  z-index: 2;
  font-family: fredokaone;
  font-size: 3.5dvh;
  cursor: pointer;
}
#check:hover {
  outline: 1.5dvh solid #c12020;
}
#next:hover {
  outline: 1.5dvh solid #c12020;
}
/* Hide scrollbar for IE, Edge and Firefox */
#question {
  -ms-overflow-style: none;  /* IE and Edge */
  scrollbar-width: none;  /* Firefox */
}
  .sqq {
    width: calc(100% - 7dvh);
    right: 1dvh;
    top: 4.5dvh;
    background-color: white;
    border-radius: 0.5dvh;
    position: absolute;
    padding: 0.5dvh;
    word-wrap: break-word;
  }

  .sqqdm {
    width: calc(100% - 7dvh);
    right: 1dvh;
    top: 4.5dvh;
    background-color: black;
    border-radius: 0.5dvh;
    position: absolute;
    padding: 0.5dvh;
    color: white;
    word-wrap: break-word;
  }
</style>
<script>
if (localStorage.getItem("darkmode") == "1") {
  document.getElementById("title").transition = "none";
  window.innerHeight;
  document.getElementById("title").style.color = "#3a3a3a";
  window.innerHeight;
  document.getElementById("title").style.transition = "0.3s color";
  document.body.style.backgroundColor = "black";
  document.getElementById("qtext2container").style.color = "white";
  document.getElementById("answer").style.color = "white";
  document.getElementById("check").style.outline = "1.5dvh solid #3a3a3a";
  document.getElementById("check").style.backgroundColor = "black";
  document.getElementById("redo").style.outline = "1.5dvh solid #3a3a3a";
  document.getElementById("redo").style.backgroundColor = "black";
  document.getElementById("finish").style.outline = "1.5dvh solid #3a3a3a";
  document.getElementById("finish").style.backgroundColor = "black";
  document.getElementById("next").style.outline = "1.5dvh solid #3a3a3a";
  document.getElementById("next").style.backgroundColor = "black";
  document.getElementById("popup").style.backgroundColor = "#3a3a3a";
  document.getElementById("question").style.color = "white";
  document.getElementById("gatb").style.backgroundImage = "linear-gradient(rgba(0,0,0,0), #3a3a3a)";
  document.getElementById("desc").style.color = "white";
  document.getElementById("whitebit").style.backgroundColor = "black";
  document.getElementById("fmq").style.backgroundColor = "#3a3a3a";
  document.getElementById("lilgrayguy").style.backgroundImage = "linear-gradient(rgba(0,0,0,0), #3a3a3a)";
  document.getElementById("middlecircle").style.backgroundColor = "black";
  document.getElementById("frontcircle").style.backgroundColor = "black";
  document.getElementById("sq").style.color = "white";
  document.getElementById("textim").style.color = "black";
}

if (sessionStorage.getItem("setToUse")) {
current = sessionStorage.getItem("setToUse");
sessionStorage.removeItem("setToUse");
} else {
window.location.href = "studyurlerror.html";
}
currentq = 1;
congratsmsg = ["Great Job!", "Perfect!", "Nice Work!", "Good Work!", "Good Job!"];
nopemsg = ["Oops", "Not quite", ":(", "Not exactly", "Erm, actually..."];
clbl = 0;
function finish() {
  window.location.href = "study".concat(current, ".html");
}
function redo() {
  sessionStorage.setItem("stu", current);
  sessionStorage.setItem("wpr", "explain");
  window.location.href = "justamoment.html";
}
con = [];
allnumbers = [];
while (parseInt(localStorage.getItem(current.concat("qat"))) != allnumbers.length) {
  randomNum = Math.floor(Math.random() * parseInt(localStorage.getItem(current.concat("qat")))) + 1;
  if (allnumbers.indexOf(randomNum) == -1) {
    allnumbers.push(randomNum);
  }
}
currentdq = 0;
function revealanswer() {
  document.getElementById("answer2").innerHTML = "<br>".concat(localStorage.getItem(current.concat("a", allnumbers[currentdq])));
}
rob = 1;
function next2() {
  pose("happy");
  document.getElementById("question").classList.add("hidden");
  document.getElementById("check").style.opacity = 0;
  setTimeout(function() {
    document.getElementById("question").style.opacity = 1;
    document.getElementById("qtext").innerHTML = "Explain this Answer:";
    document.getElementById("qtext").style.fontSize = "4dvh";
    document.getElementById("question").style.top = "14dvh";
    document.getElementById("answer2").style.pointerEvents = "all";
    document.getElementById("question2").classList.remove("hidden");
    document.getElementById("question").style.zIndex = 10;
    document.getElementById("malcircle").style.opacity = 1;
    document.getElementById("biencircle").style.opacity = 1;
    pose("normal");
  }, 800)

  setTimeout(function() {
    startTimer();
    document.body.style.transition = "0.6s background-color";
    document.getElementById("answer2").innerHTML = "<br>Click Here to Reveal the Answer"
    document.getElementById("malcircle").style.pointerEvents = "all";
    document.getElementById("biencircle").style.pointerEvents = "all";
    document.getElementById("qtext2").style.fontSize = "5.5dvh";
    document.getElementById("qtext2").textContent = localStorage.getItem(current.concat("q", allnumbers[currentdq].toString()));
  }, 800)
}
numcorrect = 0;
function bien() {
  pose("happy");
  document.getElementById("insloadbar").style.backgroundColor = "#2dcc70";
  setTimeout(function() {
    if (currentdq+1 != allnumbers.length) {
    pose("normal");
    }
  }, 800);
  con.push(1);
  if (currentdq+1 == allnumbers.length) {
    clbl = 100;
  }
  if (clbl != 100) {
  clbl += (100 - clbl) / (allnumbers.length - currentdq);
  }
  document.getElementById("insloadbar").style.width = clbl + "%";
  numcorrect++;
  if (rob == 0) {
  } else {
  }
  document.body.style.backgroundColor = "#2dcc70";
  document.getElementById("malcircle").style.pointerEvents = "none";
  document.getElementById("biencircle").style.pointerEvents = "none";
  document.getElementById("answer2").style.pointerEvents = "none";
  document.getElementById("question2").style.opacity = 0;
  document.getElementById("question").style.opacity = 0;
  setTimeout(function() {
    if (currentdq+1 != allnumbers.length) {
    if (localStorage.getItem("darkmode") == "1") {
      document.body.style.backgroundColor = "black";
    } else {
      document.body.style.backgroundColor = "white";
    }
    document.getElementById("question2").style.opacity = 1;
    document.getElementById("answer2").innerHTML = "<br>Click Here to Reveal the Answer";
    document.getElementById("answer2").style.pointerEvents = "all";
    document.getElementById("question").style.opacity = 1;
    currentdq++;
    document.getElementById("qtext2").innerHTML = localStorage.getItem(current.concat("q", allnumbers[currentdq].toString()));
    } else {
    document.body.style.transition = "none";
    setTimeout(function() {
      showresults();
    }, 2000);
    }
  }, 650)
  setTimeout(function() {
    document.getElementById("malcircle").style.pointerEvents = "all";
    document.getElementById("biencircle").style.pointerEvents = "all";
  }, 1250)
}
function mal() {
  pose("confused");
  document.getElementById("insloadbar").style.backgroundColor = "#ff8500";
  setTimeout(function() {
    pose("normal");
  }, 800);
  con.push(0);
  if (rob == 0) {
  } else {
  }
  document.body.style.backgroundColor = "#ff8500";
  document.getElementById("malcircle").style.pointerEvents = "none";
  document.getElementById("biencircle").style.pointerEvents = "none";
  document.getElementById("answer2").style.pointerEvents = "none";
  document.getElementById("question2").style.opacity = 0;
  document.getElementById("question").style.opacity = 0;
  allnumbers.push(allnumbers[currentdq]);
  if (clbl != 100) {
  clbl += (100 - clbl) / (allnumbers.length - currentdq);
  }
  document.getElementById("insloadbar").style.width = clbl + "%";
  setTimeout(function() {
    if (localStorage.getItem("darkmode") == "1") {
      document.body.style.backgroundColor = "black";
    } else {
      document.body.style.backgroundColor = "white";
    }
    document.getElementById("question2").style.opacity = 1;
    document.getElementById("answer2").innerHTML = "<br>Click Here to Reveal the Answer";
    document.getElementById("answer2").style.pointerEvents = "all";
    document.getElementById("question").style.opacity = 1;
    currentdq++;
    document.getElementById("qtext2").innerHTML = localStorage.getItem(current.concat("q", allnumbers[currentdq].toString()));
  }, 650)
  setTimeout(function() {
    document.getElementById("malcircle").style.pointerEvents = "all";
    document.getElementById("biencircle").style.pointerEvents = "all";
  }, 1250)
}
function startTimer() {
  setInterval(function() {
    if (secondsLeft == 1) {
      secondsLeft--;
      document.getElementById("qtext").innerHTML = "0";
      document.getElementById("malcircle").style.pointerEvents = "none";
      document.getElementById("biencircle").style.pointerEvents = "none";
      document.body.style.transition = "none";
      setTimeout(showresults, 2000);
    } else if (secondsLeft > 1) {
      secondsLeft--;
      document.getElementById("qtext").innerHTML = secondstostring(secondsLeft);
    } else {}
  }, 1000)
}
function secondstostring(secVal) {
  if (secVal >= 60) {
    minutesNum = (Math.floor(secVal / 60)).toString();
    secondsNum = secVal % 60;
    if (secondsNum < 10) {
      secondsNum = "0".concat(secondsNum.toString());
    } else {
      secondsNum = secondsNum.toString();
    }
    return minutesNum.concat(":", secondsNum);
  } else {
    return secVal.toString();
  }
}
// ===== Cubic Bezier Implementation =====
function cubicBezier(x1, y1, x2, y2) {
  function A(a1, a2) { return 1 - 3*a2 + 3*a1 }
  function B(a1, a2) { return 3*a2 - 6*a1 }
  function C(a1)     { return 3*a1 }

  function bezier(t, a1, a2) {
    return ((A(a1,a2)*t + B(a1,a2))*t + C(a1))*t
  }
  function slope(t, a1, a2) {
    return 3*A(a1,a2)*t*t + 2*B(a1,a2)*t + C(a1)
  }

  function getT(x) {
    let t = x
    for (let i=0; i<5; i++) {
      let s = slope(t, x1, x2)
      if (s === 0) return t
      let xCalc = bezier(t, x1, x2) - x
      t -= xCalc / s
    }
    return t
  }

  return function(x) {
    return bezier(getT(x), y1, y2)
  }
}

// ===== Animation Loop =====
function animate(target, duration, easing, callback) {
  const start = performance.now()

  function step(now) {
    let progress = Math.min((now - start) / duration, 1)
    let eased = easing(progress)
    let val = eased * target
    callback(val)
    if (progress < 1) requestAnimationFrame(step)
  }
  requestAnimationFrame(step)
}

// ===== Example easing: CSS "ease-in-out" =====
const easeInOut = cubicBezier(0.42, 0, 0.58, 1)
const frontcircle = document.getElementById("frontcircle")


// ===== Your Results Function =====
function showresults() {
  if (localStorage.getItem("darkmode") == "1") {
    document.body.style.backgroundColor = "black";
  } else {
    document.body.style.backgroundColor = "white";
  }
  howdidido = Math.floor(360 * (numcorrect / allnumbers.length)).toString();
  ofo = numcorrect / allnumbers.length;
  if (ofo < 0.4) {
    cfc = "#ff8500";
    posescore("sad");
  } else if (ofo < 0.7) {
    cfc = "#ffe017";
    posescore("confused");
  } else if (ofo < 0.9) {
    cfc = "#a8c96e";
    posescore("happy");
  } else {
    cfc = "#2dcc70";
    posescore("amazed");
  } 
  if (ofo == 1) {
    createsq("e");
  } else {
    whichqs = [];
    prevnumfound = 0;
    for (a = 0; a < parseInt(localStorage.getItem(current.concat("qat"))); a++) {
      numfound = 0;
      for (b = 0; b < allnumbers.length; b++) {
        if (allnumbers[b] == (a + 1).toString()) {
          numfound++;
        }
      }
      if (numfound > prevnumfound) {
        whichqs = [];
        whichqs.push((a + 1).toString());
        prevnumfound = numfound;
      } else if (numfound == prevnumfound) {
        whichqs.push((a + 1).toString());
      } else {}
    }
    for (z = 0; z < whichqs.length; z++) {
      createsq(whichqs[z]);
    }
  }
  if (howdidido == 360) {
  document.getElementById("percentage").style.backgroundColor = "#2dcc70";
  } else if (localStorage.getItem("darkmode") != "1") {
  document.getElementById("percentage").style.backgroundImage = "conic-gradient(".concat(cfc, " 0deg, ", cfc, " ", howdidido, "deg, #efefef ", howdidido, "deg, #efefef 360deg)");
  } else {
  document.getElementById("percentage").style.backgroundImage = "conic-gradient(".concat(cfc, " 0deg, ", cfc, " ", howdidido, "deg, #3a3a3a ", howdidido, "deg, #3a3a3a 360deg)");
  }
  document.getElementById("textim").innerHTML = Math.floor(ofo * 100) + "%";
  document.getElementById("firstpart").classList.add("hidden")
  document.getElementById("secondpart").classList.remove("hidden")
  setTimeout(function() {
    frontcircle.classList.add("hidden");
  }, 3000);
  setTimeout(function() {
      document.getElementById("textim").style.color = cfc;
  animate(360, 2000, easeInOut, (val) => {
    // Build a valid conic-gradient
    frontcircle.style.backgroundColor = "rgba(0,0,0,0)";
    if (localStorage.getItem("darkmode") == "1") {
    frontcircle.style.backgroundImage = 
      `conic-gradient(from 0deg, rgba(0,0,0,0) 0deg ${val}deg, black ${val}deg 360deg)`
    } else {
    frontcircle.style.backgroundImage = 
      `conic-gradient(from 0deg, rgba(0,0,0,0) 0deg ${val}deg, white ${val}deg 360deg)`
    }
  })}, 1000);
  setTimeout(function() {
    document.getElementById("percentage").style.top = "30dvh";
    document.getElementById("percentage").style.left = "10.5dvh";
    document.getElementById("percentage").style.width = "15dvh";
    document.getElementById("percentage").style.height = "15dvh";
    document.getElementById("textim").style.fontSize = "3.33dvh";
  }, 4000)
  setTimeout(function() {
    document.getElementById("whitebit").style.width = 0;
    document.getElementById("finish").classList.remove("hidden");
    document.getElementById("redo").classList.remove("hidden");
  }, 6000)
  
}
function createsq(type) {
  if (type == "e") {
    newSQ = document.createElement("div");
    newSQ.innerHTML = "Nice Work! No struggle questions to show.";
    if (localStorage.getItem("darkmode") == "1") {
    newSQ.classList.add("sqqdm");
    } else {
    newSQ.classList.add("sqq");
    }
    document.getElementById("fmq").appendChild(newSQ);
  } else {
    newSQ = document.createElement("div");
    newSQ.innerHTML = "Q: " + localStorage.getItem(current.concat("q", type)) + "<br><span style='font-weight: bold'>A: " + localStorage.getItem(current.concat("a", type)) + "</span>";
    if (localStorage.getItem("darkmode") == "1") {
    newSQ.classList.add("sqqdm");
    } else {
    newSQ.classList.add("sqq");
    }
    document.getElementById("fmq").appendChild(newSQ);
    resizeSQs();
  }
}

window.addEventListener("resize", resizeSQs);
function resizeSQs() {
  totaltop = 0.045 * window.innerHeight;
  for (i = 0; i < document.getElementsByClassName("sqq").length; i++) {
    document.getElementsByClassName("sqq")[i].style.top = totaltop + "px";
    totaltop += document.getElementsByClassName("sqq")[i].offsetHeight + 0.01 * window.innerHeight;
  }
}
function check() {
  document.getElementById("check").setAttribute("onclick", "");
  if (localStorage.getItem("gn") == "1") {
    correcton = localStorage.getItem(current.concat("a", allnumbers[currentq - 1])).toUpperCase() == document.getElementById("answer").value.toUpperCase();
  } else {
    newword = "";
    allwords = [];
    alphabet = ["a", "b", "c", "d", "e", "f", "g", "h", "i", "j", "k", "l", "m", "n", "o", "p", "q", "r", "s", "t", "u", "v", "w", "x", "y", "z", "0", "1", "2", "3", "4", "5", "6", "7", "8", "9"];
    thequestion = document.getElementById("answer").value.toLowerCase();
    for (i = 0; i < thequestion.length; i++) {
      if (i+1 == thequestion.length) {
        if (alphabet.indexOf(thequestion[i]) != -1) {
        allwords.push(newword.concat(thequestion[i]));
        } else if (newword != "") {
        allwords.push(newword);
        }
      } else if (alphabet.indexOf(thequestion[i]) != -1) {
        newword = newword.concat(thequestion[i]);
      } else {
        if (newword != "") {
        allwords.push(newword);
        }
        newword = "";
      }
    }
    newword = "";
    allwordsa = [];
    thequestion = localStorage.getItem(current.concat("a", allnumbers[currentq - 1])).toLowerCase();
    for (i = 0; i < thequestion.length; i++) {
      if (i+1 == thequestion.length) {
        if (alphabet.indexOf(thequestion[i]) != -1) {
        allwordsa.push(newword.concat(thequestion[i]));
        } else if (newword != "") {
        allwordsa.push(newword);
        }
      } else if (alphabet.indexOf(thequestion[i]) != -1) {
        newword = newword.concat(thequestion[i]);
      } else {
        if (newword != "") {
        allwordsa.push(newword);
        }
        newword = "";
      }
    }
    nallwords = [];
    unimportantWords = [
  "a","an","the","about","above","across","after","against","along","amid","among","around",
  "at","before","behind","below","beneath","beside","between","beyond","by","despite","down",
  "during","except","for","from","in","inside","into","near","of","off","on","onto","out",
  "outside","over","since","through","throughout","till","to","toward","under","underneath",
  "until","up","upon","with","within","without",
  "der","die","das","ein","eine","einer","einem","einen","eines","dem","den","des",
  "an","auf","aus","bei","durch","für","gegen","hinter","in","mit","nach","neben","ohne",
  "seit","um","unter","über","von","vor","während","wegen","zu","zum","zur",
  "il","lo","la","i","gli","le","un","una","uno","del","della","dello","dei","degli","dell'",
  "a","da","di","in","su","con","tra","fra","sopra","sotto","senza","dopo","prima","fino","entro",
  "le","la","les","un","une","des","du","de","d'","au","aux",
  "à","chez","dans","en","sur","sous","devant","derrière","par","pour","sans","vers",
  "avec","entre","pendant","jusqu’à","depuis","avant","après","près","autour",
  "el","la","los","las","un","una","unos","unas","al","del",
  "a","ante","bajo","con","contra","de","desde","en","entre","hacia","hasta",
  "sin","sobre","tras","durante","mediante",
  "and","or","but","nor","so","yet","for","although","because","since","unless","while","whereas","if","as","though","even","once","when",
  "und","oder","aber","denn","doch","sondern","obwohl","weil","da","wenn","falls","sowie","solange","bis","bevor","nachdem","während","obgleich",
  "e","o","ma","né","però","anche se","poiché","dato che","quando","finché","se","mentre","perché","come","anche","appena","fino a",
  "et","ou","mais","ni","car","donc","tandis que","parce que","puisque","lorsque","si","quoique","bien que","comme","pendant que","avant que","après que",
  "y","o","pero","ni","aunque","porque","pues","ya que","mientras","cuando","hasta que","si","como","una vez que"
];

    for (i = 0; i < allwords.length; i++) {
      if (unimportantWords.indexOf(allwords[i]) == -1) {
        nallwords.push(allwords[i]);
      }
    }
    allwords = nallwords;
    nallwords = [];
    for (i = 0; i < allwordsa.length; i++) {
      if (unimportantWords.indexOf(allwordsa[i]) == -1) {
        nallwords.push(allwordsa[i]);
      }
    }
    allwordsa = nallwords;
    numtobeat = allwordsa.length * 0.85;
    numhave = 0;
    for (i = 0; i < allwords.length; i++) {
      if (allwordsa.indexOf(allwords[i]) > -1) {
        ogi = i;
        if (allwordsa.indexOf(allwords[i]) <= i) {
          i--;
        }
        eindex = allwordsa.indexOf(allwords[ogi]);
        allwords.splice(allwords[ogi], 1);
        allwordsa.splice(eindex, 1);
        numhave++; 
      }
    }
    correcton = numhave >= numtobeat;
  }
  if (correcton) {
    if (currentq == allnumbers.length) {
      clbl = 100;
    }
    if (localStorage.getItem("darkmode") == "1") {
      document.getElementById("title").style.color = "white";
      document.getElementById("popup").style.boxShadow = "0 0 10dvh black";
    } else {
      document.getElementById("title").style.color = "#c12020";
      document.getElementById("popup").style.boxShadow = "0 0 10dvh rgb(173, 173, 173)";
    }
    numcorrect++;
    pose("happy");
    document.getElementById("answer").style.pointerEvents = "none";
    document.getElementById("insloadbar").style.backgroundColor = "#2dcc70";
    document.getElementById("popup").style.top = "60dvh";
    random = Math.floor(Math.random() * congratsmsg.length);
    document.getElementById("title").innerHTML = congratsmsg[random];
    document.getElementById("desc").innerHTML = "<span style='font-weight: bold'>Correct Answer: </span>".concat(localStorage.getItem(current.concat("a", allnumbers[currentq - 1])), "<br><br><br><br><br>");
  } else {
    if (localStorage.getItem("darkmode") == "1") {
      document.getElementById("title").style.color = "white";
      document.getElementById("popup").style.boxShadow = "0 0 10dvh black";
    } else {
      document.getElementById("title").style.color = "#c12020";
      document.getElementById("popup").style.boxShadow = "0 0 10dvh rgb(173, 173, 173)";
    }
    document.getElementById("answer").style.pointerEvents = "none";
    pose("confused");
    allnumbers.push(allnumbers[currentq - 1]);
    document.getElementById("popup").style.top = "60dvh";
    random = Math.floor(Math.random() * nopemsg.length);
    document.getElementById("title").innerHTML = nopemsg[random];
    document.getElementById("desc").innerHTML = "<span style='font-weight: bold'>Your Answer: </span>".concat(document.getElementById("answer").value, "<br><br><span style='font-weight: bold'>Correct Answer: </span>", localStorage.getItem(current.concat("a", allnumbers[currentq - 1])), "<br><br><br><br><br>");
  }
  if (clbl != 100) {
  clbl += (100 - clbl) / (allnumbers.length + 1 - currentq);
  }
  document.getElementById("insloadbar").style.width = clbl + "%";
}
function pose(exp) {
  if (exp == "confused") {
    document.getElementById("torahead").style.backgroundImage = "url('toraheadconfused.png')";
    document.getElementById("torahead").style.transform = "translate(-50%, -50%) rotate(30deg)";
  } else if (exp == "happy") {
    document.getElementById("torahead").style.backgroundImage = "url('toraheadhappy.png')";
    document.getElementById("torahead").style.transform = "translate(-50%, -50%) rotate(30deg)";
  } else {
    document.getElementById("torahead").style.backgroundImage = "url('toraheadnormal.png')";
    document.getElementById("torahead").style.transform = "translate(-50%, -50%) rotate(0deg)";
  }
}
function posescore(exp) {
  setTimeout(function() {
  if (exp == "confused") {
    document.getElementById("torahead2").style.backgroundImage = "url('toraheadconfused.png')";
    document.getElementById("torahead2").style.transform = "translate(-50%, -50%) rotate(30deg)";
  } else if (exp == "happy") {
    document.getElementById("torahead2").style.backgroundImage = "url('toraheadhappy.png')";
    document.getElementById("torahead2").style.transform = "translate(-50%, -50%) rotate(30deg)";
  } else if (exp == "amazed") {
    document.getElementById("torahead2").style.backgroundImage = "url('toraheadamazed.png')";
    document.getElementById("torahead2").style.transform = "translate(-50%, -50%) rotate(30deg)";
  } else {
    document.getElementById("torahead2").style.backgroundImage = "url('toraheadsad.png')";
    document.getElementById("torahead2").style.transform = "translate(-50%, -50%) rotate(30deg)";
    setTimeout(function() {
      document.getElementById("torahead2").style.transition = "1.2s transform";
      window.innerHeight;
      document.getElementById("torahead2").style.transform = "translate(-50%, -50%) rotate(-30deg)";
    }, 800);
    setTimeout(function() {
      document.getElementById("torahead2").style.transition = "0.8s transform";
      window.innerHeight;
      document.getElementById("torahead2").style.transform = "translate(-50%, -50%) rotate(0deg)";
    }, 2200)
  }
  }, 1500);
}
function next() {
  if (currentq != allnumbers.length) {
  document.getElementById("insloadbar").style.backgroundColor = "#c12020";
  pose("normal");
  document.getElementById("popup").style.top = "90dvh";
    document.getElementById("popup").style.boxShadow = "none";
    if (localStorage.getItem("darkmode") == "1") {
    document.getElementById("title").style.color = "#3a3a3a";
    } else {
    document.getElementById("title").style.color = "#efefef";
    }
    document.getElementById("desc").innerHTML = "";
    document.getElementById("question").style.opacity = 0;
    document.getElementById("answer").style.opacity = 0;
    document.getElementById("check").style.opacity = 0;
    currentq++;
    setTimeout(function() {
    document.getElementById("answer").style.pointerEvents = "all";
    document.getElementById("question").style.opacity = 1;
    document.getElementById("answer").style.opacity = 1;
    document.getElementById("check").style.opacity = 1;
    document.getElementById("qtext").innerHTML = localStorage.getItem(current.concat("q", allnumbers[currentq - 1]));
    document.getElementById("answer").value = "";
    }, 700)
    setTimeout(function() {
    document.getElementById("check").setAttribute("onclick", "check()");
    }, 1300);
  } else { showresults(); }
}
</script>
</html>
